---
# ArgoCD Application для Kafka UI (веб-интерфейс)
# Применять: kubectl apply -f argocd-apps/kafka/ui-application.yaml -n argocd
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: kafka-ui
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "2"  # После kafka-cluster (wave 1)
  finalizers:
    - resources-finalizer.argocd.argoproj.io
spec:
  project: default

  source:
    repoURL: https://github.com/barmaglot351/k3s-test.git
    targetRevision: HEAD
    path: argocd-apps/kafka/ui
    directory:
      recurse: false
      include: "*.yaml"

  destination:
    server: https://kubernetes.default.svc
    namespace: kafka

  syncPolicy:
    automated:
      prune: true
      selfHeal: true
      allowEmpty: false
    syncOptions:
      - CreateNamespace=false
    retry:
      limit: 5
      backoff:
        duration: 5s
        factor: 2
        maxDuration: 3m
