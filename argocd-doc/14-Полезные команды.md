**–ö–æ—Ä–æ—Ç–∫–∞—è, –ø—Ä–∞–∫—Ç–∏—á–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è-—à–ø–∞—Ä–≥–∞–ª–∫–∞**, —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–∞—è –∏–º–µ–Ω–Ω–æ –Ω–∞ —Å–ª—É—á–∞–∏ **Argo CD + CRD (MinIO) + –∑–∞–≤–∏—Å—à–∏–µ PVC**. –ú–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–µ–±–µ.

---

# üßπ –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å—à–µ–≥–æ Argo CD Application

*(finalizers / CRD / PVC)*

## 0Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

```bash
kubectl get app <app-name> -n argocd
kubectl get app <app-name> -n argocd -o yaml | grep deletionTimestamp
```

–ï—Å–ª–∏ –µ—Å—Ç—å `deletionTimestamp` ‚Üí –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **–∑–∞–ª–∏–ø–ª–æ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–∏**.

---

## 1Ô∏è‚É£ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –∫–∞–∫–∏–µ —Ä–µ—Å—É—Ä—Å—ã –¥–µ—Ä–∂–∞—Ç Application

```bash
kubectl get app <app-name> -n argocd -o yaml
```

–ò—â–∏ –≤:

```yaml
status:
  resources:
```

–û–±—ã—á–Ω–æ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ:

* Tenant / CRD
* PVC
* Certificate
* IngressRoute
* Application (self-reference)

---

## 2Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å PVC (—Å–∞–º–∞—è —á–∞—Å—Ç–∞—è –ø—Ä–∏—á–∏–Ω–∞)

```bash
kubectl get pvc -n <target-namespace>
```

–ü—Ä–∏–º–µ—Ä:

```bash
kubectl get pvc -n minio-operator
```

---

## 3Ô∏è‚É£ –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ù–ï –Ω—É–∂–Ω—ã ‚Äî —É–¥–∞–ª–∏—Ç—å PVC

```bash
kubectl delete pvc <pvc-name> -n <namespace>
```

–ü—Ä–æ–≤–µ—Ä–∫–∞:

```bash
kubectl get pvc -n <namespace>
```

---

## 4Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å CRD-—Ä–µ—Å—É—Ä—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, MinIO Tenant)

```bash
kubectl get tenant -n minio-operator
kubectl delete tenant <tenant-name> -n minio-operator
```

–ï—Å–ª–∏ –∑–∞–ª–∏–ø:

```bash
kubectl patch tenant <tenant-name> -n minio-operator \
  --type=json \
  -p='[{"op":"remove","path":"/metadata/finalizers"}]'
```

---

## 5Ô∏è‚É£ –ï—Å–ª–∏ Application –≤—Å—ë –µ—â—ë –≤–∏—Å–∏—Ç ‚Äî —É–±—Ä–∞—Ç—å finalizers —É Argo CD

‚ö†Ô∏è –î–µ–ª–∞–π **—Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —É–≤–µ—Ä–µ–Ω**, —á—Ç–æ —Ä–µ—Å—É—Ä—Å—ã –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω—ã.

```bash
kubectl patch application <app-name> -n argocd \
  --type=json \
  -p='[{"op":"remove","path":"/metadata/finalizers"}]'
```

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:

```bash
kubectl edit application <app-name> -n argocd
```

–£–¥–∞–ª–∏—Ç—å:

```yaml
finalizers:
- resources-finalizer.argocd.argoproj.io
- resources-finalizer.argocd.argoproj.io/foreground
```

---

## 6Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –≤—Å—ë –æ—á–∏—â–µ–Ω–æ

```bash
kubectl get app -n argocd
kubectl get all -n <target-namespace>
kubectl get pvc -n <target-namespace>
```

---

# üî• –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (–∫–æ–≥–¥–∞ ¬´–ø—Ä–æ—Å—Ç–æ —É–±–∏—Ç—å¬ª)

```bash
kubectl delete app <app-name> -n argocd --force --grace-period=0
kubectl patch app <app-name> -n argocd \
  --type=json \
  -p='[{"op":"remove","path":"/metadata/finalizers"}]'
```

---

# üß† –ü–æ–ª–µ–∑–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

* **PVC –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –ø—Ä–∏—á–∏–Ω–∞ –∑–∞–ª–∏–ø–∞**
* CRD (MinIO, Prometheus, Cert-manager) —á–∞—Å—Ç–æ –∏–º–µ—é—Ç —Å–≤–æ–∏ finalizers
* `local-path` storage **–Ω–µ —É–¥–∞–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**
* Argo CD `foreground deletion` —É—Å–∏–ª–∏–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç –∑–∞–ª–∏–ø–∞–Ω–∏—è

---

# ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫ —É–¥–∞–ª–µ–Ω–∏—è

1. PVC
2. CRD (Tenant / Prometheus / etc)
3. Application finalizers

---

### –ü—Ä–∏–º–µ—Ä –Ω–∞ Minio Tenant

–û–∫–µ–π, –¥–∞–≤–∞–π **–ø—Ä—è–º–æ –ø–æ —à–∞–≥–∞–º, –Ω–∞ –∂–∏–≤–æ–º –ø—Ä–∏–º–µ—Ä–µ `minio-tenant`**, –∫–∞–∫ –±—É–¥—Ç–æ —ç—Ç–æ runbook –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞. –ë–µ–∑ –≤–æ–¥—ã.

---

# üßπ –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å—à–µ–≥–æ Argo CD Application `minio-tenant`

## –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

* Argo CD Application: `minio-tenant`
* Namespace Argo CD: `argocd`
* Namespace MinIO: `minio-operator`
* StorageClass: `local-path`
* –°–∏–º–ø—Ç–æ–º: `Application` –≤–∏—Å–∏—Ç –≤ `Terminating`

---

## 1Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ –∑–∞–ª–∏–ø–ª–æ

```bash
kubectl get app minio-tenant -n argocd
```

–ü—Ä–æ–≤–µ—Ä—è–µ–º `deletionTimestamp`:

```bash
kubectl get app minio-tenant -n argocd -o yaml | grep deletionTimestamp
```

–û–∂–∏–¥–∞–µ–º–æ:

```text
deletionTimestamp: 2026-01-29T23:33:01Z
```

---

## 2Ô∏è‚É£ –°–º–æ—Ç—Ä–∏–º, –∫–∞–∫–∏–µ —Ä–µ—Å—É—Ä—Å—ã –¥–µ—Ä–∂–∞—Ç Application

```bash
kubectl get app minio-tenant -n argocd -o yaml
```

–ö—Ä–∏—Ç–∏—á–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏:

```yaml
finalizers:
- resources-finalizer.argocd.argoproj.io
- resources-finalizer.argocd.argoproj.io/foreground
```

–ò —Ä–µ—Å—É—Ä—Å—ã:

* `Tenant minio-tenant`
* `PVC data0-minio-tenant-pool-0-0`

---

## 3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—è–µ–º PVC (–≥–ª–∞–≤–Ω—ã–π –±–ª–æ–∫–µ—Ä)

```bash
kubectl get pvc -n minio-operator
```

–§–∞–∫—Ç:

```text
data0-minio-tenant-pool-0-0   Bound   local-path
```

---

## 4Ô∏è‚É£ –£–¥–∞–ª—è–µ–º PVC (–¥–∞–Ω–Ω—ã–µ –Ω–µ –Ω—É–∂–Ω—ã)

```bash
kubectl delete pvc data0-minio-tenant-pool-0-0 -n minio-operator
```

–ü—Ä–æ–≤–µ—Ä–∫–∞:

```bash
kubectl get pvc -n minio-operator
# No resources found
```

---

## 5Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—è–µ–º Tenant

```bash
kubectl get tenant -n minio-operator
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:

```text
No resources found
```

üëâ Tenant **—É–¥–∞–ª–∏–ª—Å—è —Å–∞–º**, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –∏—Å—á–µ–∑ PVC.

(–ï—Å–ª–∏ –±—ã –Ω–µ —É–¥–∞–ª–∏–ª—Å—è ‚Äî —Å–Ω–∏–º–∞–ª–∏ –±—ã finalizer —É Tenant.)

---

## 6Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—è–µ–º Application –µ—â—ë —Ä–∞–∑

```bash
kubectl get app minio-tenant -n argocd
```

–ï—Å–ª–∏ –≤—Å—ë –µ—â—ë –≤–∏—Å–∏—Ç ‚Üí Argo CD –Ω–µ —É–±—Ä–∞–ª finalizer.

---

## 7Ô∏è‚É£ –£–¥–∞–ª—è–µ–º finalizers —É Application (–±–µ–∑–æ–ø–∞—Å–Ω–æ)

```bash
kubectl patch application minio-tenant -n argocd \
  --type=json \
  -p='[{"op":"remove","path":"/metadata/finalizers"}]'
```

---

## 8Ô∏è‚É£ –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```bash
kubectl get app minio-tenant -n argocd
# Error from server (NotFound)
```

–ü—Ä–æ–≤–µ—Ä—è–µ–º namespace MinIO:

```bash
kubectl get all -n minio-operator
kubectl get pvc -n minio-operator
```

---

# ‚úÖ –ò—Ç–æ–≥

* ‚úî PVC —É–¥–∞–ª—ë–Ω
* ‚úî Tenant —É–¥–∞–ª—ë–Ω
* ‚úî Argo CD Application —É–¥–∞–ª–µ–Ω–æ
* ‚úî –ù–∏—á–µ–≥–æ –Ω–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç—Å—è
* ‚úî –ö–ª–∞—Å—Ç–µ—Ä —á–∏—Å—Ç

---

## üß† –í–∞–∂–Ω—ã–µ –≤—ã–≤–æ–¥—ã –∏–º–µ–Ω–Ω–æ –¥–ª—è MinIO

* `PVC ‚Üí Tenant ‚Üí Application` ‚Äî **—Å—Ç—Ä–æ–≥–∏–π –ø–æ—Ä—è–¥–æ–∫**
* `local-path` = –≤—Å–µ–≥–¥–∞ —Ä—É—á–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å
* Argo CD + MinIO Operator = –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ finalizers

---
